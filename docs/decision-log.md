# docs/decision-log.md — campus-hub 工程决策记录

> 本文档用于记录 **campus-hub 项目中的关键工程决策**。
>
> 目的：
>
> * 防止重复讨论已经想清楚的问题
> * 保证多人 / 多轮开发中的工程一致性
> * 为未来回溯与重构提供上下文依据
>
> 规则：
>
> * 只记录「已经做出的决定」
> * 每条决策必须说明 **为什么这样选**
> * 若决策被推翻，应新增记录而非删除旧记录

---

## DL-001 项目定位与目标

* **状态**：Accepted
* **日期**：2025-01

### 决策

campus-hub 定位为一个 **面向高校校园的社区平台 Demo**，融合论坛、校内墙、实时聊天与资料互助功能。

### 原因

* 校园场景信息密集、需求真实
* 功能复杂度适中，适合作为完整工程练习
* 可扩展为长期项目

### 影响

* 后续功能设计需围绕“社区/交流”展开
* 非核心功能（商业化、推荐算法）暂不纳入

---

## DL-002 工程名称与命名策略

* **状态**：Accepted
* **日期**：2025-01

### 决策

* Git 仓库名使用 **campus-hub**（暂定）
* 产品展示名使用 **校圈**（可变）

### 原因

* 工程名需技术中性、长期可用
* 产品名允许根据场景与 UI 调整

### 影响

* 文档、代码、目录结构统一使用 campus-hub
* 对外展示可使用不同产品名

---

## DL-003 技术路线选择

* **状态**：Accepted
* **日期**：2025-01

### 决策

采用分阶段技术路线：

* Phase A：Web 客户端 + Go 后端（Demo）
* Phase B：工程加固（协议冻结）
* Phase C：迁移至 Kotlin Multiplatform 客户端

### 原因

* Web 开发效率高，Demo 成功率最大
* Go 后端稳定、性能好、长期维护成本低
* KMP 适合作为后期长期客户端方案

### 影响

* 后端 API 与 WebSocket 协议需优先稳定
* 客户端实现需遵循协议而非私有逻辑

---

## DL-004 架构原则

* **状态**：Accepted
* **日期**：2025-01

### 决策

确立以下架构原则：

* 后端稳定，客户端可替换
* 协议优先于 UI
* 核心领域模型优先冻结

### 原因

* 避免客户端更换导致系统重写
* 降低技术选型变化的影响

### 影响

* API / WS 协议修改需谨慎
* 新功能需评估对领域模型的影响

---

## DL-005 WebSocket 协议设计策略

* **状态**：Accepted
* **日期**：2025-01

### 决策

WebSocket 通信采用 **统一事件信封格式**，包含版本号与事件类型。

### 原因

* 便于多客户端（Web / KMP）共享协议
* 支持协议向后兼容与演进

### 影响

* 所有实时事件必须符合信封格式
* 客户端需按事件类型分发处理

---

## DL-006 文档体系规范

* **状态**：Accepted
* **日期**：2025-01

### 决策

项目文档拆分为以下核心文件：

* `docs/spec.md`
* `docs/api.md`
* `docs/ws-protocol.md`
* `docs/decision-log.md`

### 原因

* 单一文档难以承载不同层级信息
* 分离后更易维护与演进

### 影响

* 新增协议或核心设计需更新对应文档
* 关键决策必须记录在 decision-log 中

---

> 本决策记录为 **长期文档**，应随项目演进持续追加。
